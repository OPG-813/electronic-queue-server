openapi: 3.0.0
info:
  title: Electronic Queue NSUEM
  version: '1.0'
  description: An API for electronic queue system from NSUEM.
  contact:
    name: Danil
    url: 'https://github.com/DanilSord'
    email: kincharov99@gmail.com
  license:
    name: MIT
servers:
  - url: 'https://api.queue-nsuem.web-code-developers.ru'
    description: test server
tags:
  - name: User
    description: APIпользователей.
  - name: Admin
    description: API администратора.
  - name: System
    description: API системы.
paths:
  /user/login:
    post:
      summary: User login
      operationId: post-user-login
      responses:
        '200':
          description: OK
          headers: {}
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    format: uuid
                    example: 123e4567-e89b-12d3-a456-426614174000
                    description: |
                      id
                  username:
                    type: string
                    example: admin
                    description: Имя пользователя
                  role:
                    type: string
                    example: ADMIN
                    description: Роль пользователя
                required:
                  - id
                  - username
                  - role
        '400':
          $ref: '#/components/responses/Bad-Request'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/Internal-Server-Error'
      description: Аутентификация пользователя по имени пользователя и паролю.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  description: Имя пользователя
                  example: admin
                password:
                  type: string
                  description: Пароль
                  example: Qwerty123!
              required:
                - username
                - password
        description: Параметры тела запроса.
      x-internal: false
      tags:
        - User
    parameters: []
  /user/logout:
    get:
      summary: User logout
      tags:
        - User
      responses:
        '200':
          description: OK
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/Internal-Server-Error'
      operationId: get-user-logout
      description: Выход пользователя из учётной записи.
      parameters:
        - schema:
            type: string
          in: cookie
          name: token
          description: Сессионный токен пользователя.
  /admin/register:
    post:
      summary: Admin register
      operationId: post-admin-register
      responses:
        '200':
          description: OK
        '400':
          $ref: '#/components/responses/Bad-Request'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/Internal-Server-Error'
      description: Регистрация администратора в системе.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: admin
                  description: Имя пользователя
                password:
                  type: string
                  example: Qwerty123!
                  description: Пароль
                name:
                  type: string
                  example: Admin
                  description: ФИО администратора
              required:
                - username
                - password
                - name
        description: Параметры тела запроса.
      tags:
        - Admin
  /admin/me:
    get:
      summary: Admin me
      tags:
        - Admin
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: Id администратора
                    example: 8ce923c0-4157-487d-ab62-8cc48b0df76f
                  name:
                    type: string
                    description: ФИО администратора.
                    example: Admin
                  user:
                    type: object
                    required:
                      - id
                      - role
                      - username
                    description: Объект с данными о пользователе.
                    properties:
                      id:
                        type: string
                        description: Id пользователя.
                        example: a01bec54-0fcd-4729-aa9d-0c5043712ff5
                      role:
                        type: string
                        description: Роль пользователя.
                        example: ADMIN
                      username:
                        type: string
                        description: Имя пользователя.
                        example: admin
                  userId:
                    type: string
                    description: Id пользователя
                    example: a01bec54-0fcd-4729-aa9d-0c5043712ff5
                required:
                  - id
                  - name
                  - user
                  - userId
        '400':
          $ref: '#/components/responses/Bad-Request'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/Internal-Server-Error'
      operationId: get-admin-me
      description: Получение данных об аккаунте администратора.
      parameters:
        - schema:
            type: string
          in: cookie
          name: token
          description: Сессионный токен пользователя.
  /system/status:
    get:
      summary: System status
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: 76fb63b3-1b56-4747-8f81-a9d132cd6642
                    description: id системы.
                  endDate:
                    type: string
                    example: '2100-01-01'
                    description: 'Дата, после которой система прекратит приём заявок.'
                  endTime:
                    type: string
                    example: '24:00:00'
                    description: 'Время суток, после которого система прекратит приём заявок.'
                  startDate:
                    type: string
                    example: '2000-01-01'
                    description: 'Дата, с которой система начнёт приём заявок.'
                  startTime:
                    type: string
                    example: '00:00:00'
                    description: 'Время, с которого система начнёт приём заявок.'
                  status:
                    type: string
                    enum:
                      - 'off'
                      - 'on'
                    description: Статус работы системы.
                  timezone:
                    type: string
                    example: Asia/Novosibirsk
                    description: 'Временная зона, в которой идёт отсчёт времени системы.'
                required:
                  - id
                  - endDate
                  - endTime
                  - startDate
                  - startTime
                  - status
                  - timezone
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/Internal-Server-Error'
      operationId: get-system-status
      description: Получение данных о состоянии системы.
      parameters:
        - schema:
            type: string
          in: cookie
          name: token
          description: Сессионный токен пользователя.
      tags:
        - System
components:
  schemas:
    SystemUser:
      title: SystemUser
      type: object
      description: Пользователь системы.
      properties:
        id:
          type: string
          description: Id пользователя в формате uuid.
          format: uuid
          example: 123e4567-e89b-12d3-a456-426614174000
        role:
          type: string
          description: Роль пользователя
          example: ADMIN
        username:
          type: string
          description: Имя пользователя
          example: admin
        password:
          type: string
          description: Пароль
          example: Qwerty123!
      required:
        - id
        - role
        - username
        - password
    AdminUser:
      title: AdminUser
      type: object
      description: Администратор системы. Может быть только один.
      properties:
        id:
          type: string
          example: 123e4567-e89b-12d3-a456-426614174000
          description: Id в формате uuid
        userId:
          type: string
          example: 123e4567-e89b-12d3-a456-426614174000
          description: id связанного пользователя
        name:
          type: string
          example: Админ Такой То
          description: ФИО администратора
      required:
        - id
        - userId
        - name
  responses:
    Bad-Request:
      description: Bad request!
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: Сообщение об ошибке
                example: Bad request!
              httpCode:
                type: number
                description: HTTP код ошибки
                example: 400
              data:
                type: object
                description: Объект с дополнительной информацией
            required:
              - message
              - httpCode
          examples: {}
      headers: {}
    Conflict:
      description: Data conflict error!
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                description: Сообщение об ошибке
                example: Data conflict error!
              httpCode:
                type: number
                description: HTTP код ошибки
                example: 409
              data:
                type: object
                description: Объект с дополнительной информацией
            required:
              - message
              - httpCode
              - data
    Internal-Server-Error:
      description: Internal server error!
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: ' Internal server error!'
                description: Сообщение об ошибке.
              httpCode:
                type: number
                example: 500
                description: HTTP код ошибки
              data:
                type: object
                description: Объект с дополнительной информацией. Отсутствует.
            required:
              - message
              - httpCode
    Unauthorized:
      description: Not uthorized!
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Not uthorized!
                description: Сообщение об ошибке
              httpCode:
                type: string
                example: '401'
                description: HTTP код ошибки
              data:
                type: object
                description: Объект с дополнительной информацией
            required:
              - message
              - httpCode
    Forbidden:
      description: Not enough rights!
      content:
        application/json:
          schema:
            type: object
            properties:
              message:
                type: string
                example: Not enough rights!
                description: Сообщение об ошибке.
              httpCode:
                type: string
                description: HTTP код ошибки
                example: '403'
              data:
                type: object
                description: Объект с дополнительной информацией.
            required:
              - message
              - httpCode
  securitySchemes: {}
security: []
